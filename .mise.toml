[tools]
bun = "1.3.5"
node = "24.11.1"

[env]
NODE_OPTIONS = "--no-deprecation"
PROD_ENV_FILE = ".env.production"
PROD_COMPOSE_FILE = "compose.prod.yaml"

[tasks.check]
description = "環境検証 (Docker, 設定ファイル)"
run = "bun scripts/check-env.ts"

[tasks.install]
description = "依存関係のインストール"
run = "bun install --frozen-lockfile"
sources = ["bun.lock", "package.json"]

[tasks."dev:db"]
description = "開発用DBを起動"
run = "docker compose up -d postgres"

[tasks."dev:db:stop"]
description = "開発用DBを停止"
run = "docker compose stop postgres"

[tasks."reset:db"]
description = "開発用DBのデータを削除"
depends = ["check"]
run = "bun scripts/reset-db.ts"

[tasks.dev]
description = "開発サーバーを起動"
depends = ["install", "check"]
run = "bun scripts/dev.ts"

[tasks."prod:up"]
description = "本番環境をビルドして起動"
run = "bun scripts/prod.ts up"

[tasks."prod:down"]
description = "本番環境を停止"
run = "bun scripts/prod.ts down"

[tasks."reset:db:prod"]
description = "本番用DBデータを削除"
depends = ["check"]
run = "bun scripts/prod.ts reset"
